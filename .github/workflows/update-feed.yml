name: GÃ¼nlÃ¼k RSS Feed GÃ¼ncelle

on:
  schedule:
    - cron: '0 6 * * *'
    - cron: '0 18 * * *'
  workflow_dispatch:

permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  update-feed:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Python Kur
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: BaÄŸÄ±mlÄ±lÄ±klarÄ± YÃ¼kle
        run: pip install -r requirements.txt

      - name: docs klasÃ¶rÃ¼nÃ¼ oluÅŸtur
        run: mkdir -p docs

      - name: RSS Feed OluÅŸtur
        run: python generate_feed.py

      - name: Index sayfasÄ± oluÅŸtur
        run: |
          cat > docs/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="tr">
          <head>
            <meta charset="UTF-8">
            <title>Dijital DÃ¼nya - RSS Feed</title>
          </head>
          <body>
            <h1>ðŸ“¡ Dijital DÃ¼nya - GÃ¼nlÃ¼k Haberler</h1>
            <p><a href="feed.xml">RSS Feed</a></p>
          </body>
          </html>
          EOF

      - name: DeÄŸiÅŸiklikleri Kaydet
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "RSS Bot"
          git add docs/
          git diff --staged --quiet || git commit -m "ðŸ”„ RSS feed gÃ¼ncellendi - $(date +'%Y-%m-%d %H:%M')"
          git push
